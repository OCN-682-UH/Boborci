---
title: "Week 6 Homework"
author: "Madigan Boborci"
date: "2025-10-1"
date-modified: today
format: 
  html:
    toc: true
    theme: cerulean
    mainfont: "Georgia"
    prefer-html: true

---
knitr: 
  opts_chunk:
      fig.path: "../Output/" ----- saves figs to output, but won't render on the html when in the YAML
      
## **Introduction:**

This document is for Week 6 homework. It will include:

-   Code chunks
-   Figures
-   Tables

```{r}
#| message: false
#| warning: false
library(tidyverse)
library(here)
library(kableExtra)
library(fishualize)

```

## **Data selection:**

I have chosen to look at data from the **_Site Characteristics Data_** from sites in Mo'orea. I have also taken a look at the **_Data Dictionary_** to get insight about the data that were collected. These data were collected by Dr.Nyssa Silbiger.

```{r}
#| message: false
#| warning: false
MooreaData<-read_csv(here("Week_06","Data","site.characteristics.data.csv"))    #read in the data
DataDictionary<-read_csv(here("Week_06", "Data", "data_dictionary.csv"))
#take a look at the data

glimpse(MooreaData)
View(MooreaData)
View(DataDictionary)

```

## **Data Analysis:**

For this data set, I am going to take a look at the relationship between CCA cover and Algal cover, along with the percent of Nitrogen found in the tissue of *Sargassum sp* at each site. All sites are situated on the North Shore of Mo'orea.

![](https://www.divediscovery.com/images/moorea_map.jpg){fig-align="center" width="40%"}

#### This code chunk is going to extract the data we want to work with from the larger dataset. 

```{r}
##Need to filter out just the data we want: Site name, CCA cover, Algal Cover, %N

#| warning: false
#| message: false
PlotData<-MooreaData %>%
  drop_na()%>%
   group_by(name, parameter.measured, values)%>%          #sort by these columns
  summarise(mean_vals=mean(values, na.rm=TRUE))%>%     #mean values of each parameter per site
  mutate(parameter.measured= case_when(
    parameter.measured=="N"~"Nitrogen",              #change parameters to match data dictionary 
    parameter.measured=="CCA.cover"~"CCA Cover",
    parameter.measured=="algal.cover"~"Fleshy Algae Cover",
  TRUE~parameter.measured))%>%
filter(parameter.measured %in% c("Nitrogen","CCA Cover","Fleshy Algae Cover"))   #filter out the other parameters I don't want

```



#### This code will show a plot of % Algae and % CCA Cover for each of the sites 

```{r}
#| label: fig-cca
#| fig-cap: Figure showing percent cover CCA, Algae, and percent Nitrogen at each site
#| out-width: "75%"
#| fig-align: "center"

PlotData %>%
  ggplot(aes(x=parameter.measured, y=mean_vals, group = parameter.measured, fill=parameter.measured))+
  geom_bar(stat="identity")+        ###Allows the axes to be what I determine
  facet_wrap(~name)+                 ### Facet the graphs by site, shows means of each parameter for each
  scale_fill_fish_d(option = "Scarus_quoyi")+      ###Color scheme from fishualize package
labs(title="Substrate Cover and Nitrogen Percentages at each Site",                  
     subtitle="Mean Percentages of CCA and Fleshy Algae cover at sites in Mo'orea",
     x=NULL,
     y="Percent",                                            ###Change axes and Titles etc
     fill="Value Measured")+
  theme_minimal()+                                     
  theme(axis.title=element_text(size=15))+
  theme(plot.title=element_text(size=15,
                                face="bold"))+
  theme(axis.text.x = element_text(angle=45,hjust = 1))    

```



#### This code will create a plot to show the breakdown of substrate cover at the site with the most CCA cover

```{r}
#| message: false
Plot2Data<-MooreaData %>%
  drop_na()%>%
   group_by(name, parameter.measured, values)%>%             #sort by these columns
  mutate(parameter.measured= case_when(
    parameter.measured=="CCA.cover"~"CCA Cover",           #change parameters to match data dictionary 
    parameter.measured=="algal.cover"~"Algae Cover",
    parameter.measured=="p.acuta.cover"~"Porites acuta Cover",
    parameter.measured=="substrate.cover"~"Other Cover",
    parameter.measured=="coral.cover"~"Coral Cover",
  TRUE~parameter.measured))%>%
filter(parameter.measured %in% c("CCA Cover","Algae Cover","Porites acuta Cover","Other Cover","Coral Cover"))%>%   #filter out the other parameters I don't want
filter(name== "Creepy Tree")

Plot2Data$parameter.measured<- factor(Plot2Data$parameter.measured, levels = c("CCA Cover","Coral Cover","Algae Cover","Porites acuta Cover","Other Cover"))
```

```{r}
#| label: fig-Cover
#| fig-cap: Figure showing percent cover breakdown at site Creepy Tree 
#| out-width: "75%"
#| fig-align: "center"
#| 
Plot2Data %>%
  ggplot(aes(x=parameter.measured, y=values, group = parameter.measured, fill=parameter.measured))+ 
  geom_bar(stat ="identity")+       
  scale_fill_fish_d(option = "Scarus_quoyi")+   ###Color scheme from fishualize package
labs(title="Percent Substrate Cover",                  
     subtitle=" Percentages of Substrate Cover at Site Creepy Tree",
     x=NULL,
     y="Percent Cover",                                            ###Change axes and Titles etc
     fill="Substrate Type")+
  theme_minimal()+                                     
  theme(axis.title=element_text(size=15))+
  theme(plot.title=element_text(size=15,
                                face="bold"))+
  theme(axis.text.x = element_text(angle=45,hjust = 1))    

```



#### This code will make a nice table to assess the Nitrogen percentage in _Sargassum sp_ taken at each site


```{r}

TableData<-MooreaData%>%
  filter(parameter.measured %in% c("N","CCA.cover", "algal.cover"))%>%
  pivot_wider(names_from=parameter.measured,
              values_from= values)%>%
  group_by(name)%>%
  mutate(site.letter=NULL, site.block=NULL)


```


```{r}
#| label: tbl-CCA     #use tbl to label table
#| tbl-cap: "Percent Cover of CCA and Algae and Percent Nitrogen Values per Site "

TableData%>%
  kbl(col.names=c("Site",  "% Nitrogen", "% CCA Cover", "% Algae Cover"))%>%
   row_spec(6, bold=TRUE, color="black", background="lightpink")%>%
  kable_material() 
```




## **Summary:**

As seen in @fig-cca, one of the sites with the lowest percent algal cover also displayed the highest percent CCA cover. These specific values are highlighted in @tbl-CCA. As seen in @tbl-CCA, the only other site with that low percentage of algae cover had a higher % Nitrogen detected in _Sargassum sp_ tissue. In addition, the total substrate cover makeup was closer examined at that site in @fig-Cover.






