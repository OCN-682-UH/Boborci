---
title: "Week 6 Homework"
author: "Madigan Boborci"
date: "2025-10-1"
date-modified: today
format: 
  html:
    toc: true
    theme: minty
---

## Introduction:

This document is for Week 6 homework. It will include:

-   Code chunks
-   Figures
-   Tables

```{r}
#| message: false
#| warning: false
library(tidyverse)
library(here)
library(kableExtra)
library(fishualize)

```

## Data selection

I have chosen to look at data from the **_Site Characteristics Data_** from sites in Mo'orea. I have also taken a look at the **_Data Dictionary_** to get insight about the data that were collected. These data were collected by Dr.Nyssa Silbiger.

```{r}
#| message: false
#| warning: false
MooreaData<-read_csv(here("Week_06","Data","site.characteristics.data.csv"))    #read in the data
DataDictionary<-read_csv(here("Week_06", "Data", "data_dictionary.csv"))
#take a look at the data

glimpse(MooreaData)
View(MooreaData)
View(DataDictionary)

```

## Data Analysis

For this data set, I am going to take a look at the relationship between CCA cover and Algal cover, along with the percent of Nitrogen found in the tissue of *Sargassum sp* at each site. All sites are situated on the North Shore of Mo'orea.

![](https://www.divediscovery.com/images/moorea_map.jpg){fig-align="center" width="40%"}

#### This code chunk is going to extract the data we want to work with from the larger dataset. 

```{r}
##Need to filter out just the data we want: Site name, CCA cover, Algal Cover, %N

PlotData<-MooreaData %>%
  drop_na()%>%
   group_by(name, parameter.measured, values)%>%             #sort by these columns
  summarise(mean_vals=mean(values, na.rm=TRUE))%>%           #mean values of each parameter per site
  mutate(parameter.measured= case_when(
    parameter.measured=="N"~"Nitrogen",                    #change parameters to match data dictionary 
    parameter.measured=="CCA.cover"~"CCA Cover",
    parameter.measured=="algal.cover"~"Fleshy Algae Cover",
  TRUE~parameter.measured))%>%
filter(parameter.measured %in% c("Nitrogen","CCA Cover","Fleshy Algae Cover"))   #filter out the other parameters I don't want

```


#### This code will make a nice table to assess the Nitrogen percentage in _Sargassum sp_ taken at each site







#### This code will show a plot of % Algae and % CCA Cover for each of the sites 

```{r}
#| label: fig-CCA
#| fig-cap: Figure showing percent cover of CCA, Algae, and percent Nitrogen at each site
#| out-width: "75%"
#| fig-align: "center"
#| 
PlotData %>%
  ggplot(aes(x=parameter.measured, y=mean_vals, group = parameter.measured, fill=parameter.measured))+
  geom_bar(stat="identity")+        ###Allows the axes to be what I determine
  facet_wrap(~name)+                 ### Facet the graphs by site, shows means of each parameter for each
  scale_fill_fish_d(option = "Scarus_quoyi")+      ###Color scheme from fishualize package
labs(title="Substrate Cover and Nitrogen Percentages at each Site",                  
     subtitle="Mean Percentages of CCA and Fleshy Algae cover at sites in Mo'orea",
     x=NULL,
     y="Percent Cover",                                            ###Change axes and Titles etc
     fill="Value Measured")+
  theme_minimal()+                                     
  theme(axis.title=element_text(size=15))+
  theme(plot.title=element_text(size=15,
                                face="bold"))+
  theme(axis.text.x = element_text(angle=45,hjust = 1))    

```

```{r}

TableData<-PlotData%>%
  pivot_wider(names_from=parameter.measured,
              values_from= mean_vals)%>%    
  group_by(name)%>%
  mutate(values=NULL)
```

```{r}
#| label: tbl-CCA     #use tbl to label table
#| tbl-cap: "Percent Cover of CCA and Algae and Percent Nitrogen Values per Site "

TableData%>%
  kbl()%>%  ##PLEASE LET ME MAKE EACH SITE HAVE ONE VALUE PER COLUMN WITH NO NAS PLEASE
  collapse_rows(column=1)%>%
  kable_paper() #need to change column names 
```



## Summary
As seen in @fig-CCA, the site with the lowest percent algal cover also displayed the highest percent CCA cover. These specific values are highlighted in @tbl-CCA. In addition, the percet Nitrogen per site was closer examined in Fig 2 (will be showing nitrogen values closer, maybe compare to other N values?) and those values are delineated in @tbl-CCA as well. 




